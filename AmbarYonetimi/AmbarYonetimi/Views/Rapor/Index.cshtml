@{
    ViewData["Title"] = "📊 Depo Raporları";
}

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
    .depo-card {
        transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        border-radius: 15px;
        border: none;
    }

        .depo-card:hover {
            transform: scale(1.03);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

    .card-icon {
        font-size: 2rem;
        margin-bottom: 10px;
    }
</style>

<div class="container mt-5">
    <h2 class="text-center mb-5 fw-bold">📄 Depo Raporları</h2>

    <div class="row g-4 justify-content-center">

        @* Başlık Deposu *@
        <div class="col-md-4">
            <div class="card depo-card shadow-sm border-start border-5 border-success">
                <div class="card-body text-center">
                    <div class="card-icon text-success"><i class="fas fa-box-open"></i></div>
                    <h5 class="card-title">Başlık Deposu</h5>
                    <p class="card-text">Başlık deposundaki verileri Excel'e aktar.</p>
                    <button onclick="downloadExcel('BaslikDepo')" class="btn btn-success w-100">📥 Raporu İndir</button>
                </div>
            </div>
        </div>

        @* İskelet Deposu *@
        <div class="col-md-4">
            <div class="card depo-card shadow-sm border-start border-5 border-primary">
                <div class="card-body text-center">
                    <div class="card-icon text-primary"><i class="fas fa-cogs"></i></div>
                    <h5 class="card-title">İskelet Deposu</h5>
                    <p class="card-text">İskelet deposundaki verileri Excel'e aktar.</p>
                    <button onclick="downloadExcel('IskeletDepo')" class="btn btn-primary w-100">📥 Raporu İndir</button>
                </div>
            </div>
        </div>

        @* Kılıf Deposu *@
        <div class="col-md-4">
            <div class="card depo-card shadow-sm border-start border-5 border-warning">
                <div class="card-body text-center">
                    <div class="card-icon text-warning"><i class="fas fa-tshirt"></i></div>
                    <h5 class="card-title">Kılıf Deposu</h5>
                    <p class="card-text">Kılıf deposundaki verileri Excel'e aktar.</p>
                    <button onclick="downloadExcel('KilifDepo')" class="btn btn-warning w-100 text-dark">📥 Raporu İndir</button>
                </div>
            </div>
        </div>

        @* Kolçak Deposu *@
        <div class="col-md-4">
            <div class="card depo-card shadow-sm border-start border-5 border-danger">
                <div class="card-body text-center">
                    <div class="card-icon text-danger"><i class="fas fa-hand-paper"></i></div>
                    <h5 class="card-title">Kolçak Deposu</h5>
                    <p class="card-text">Kolçak deposundaki verileri Excel'e aktar.</p>
                    <button onclick="downloadExcel('KolcakDepo')" class="btn btn-danger w-100">📥 Raporu İndir</button>
                </div>
            </div>
        </div>

        @* Sünger Deposu *@
        <div class="col-md-4">
            <div class="card depo-card shadow-sm border-start border-5 border-info">
                <div class="card-body text-center">
                    <div class="card-icon text-info"><i class="fas fa-cube"></i></div>
                    <h5 class="card-title">Sünger Deposu</h5>
                    <p class="card-text">Sünger deposundaki verileri Excel'e aktar.</p>
                    <button onclick="downloadExcel('SungerDepo')" class="btn btn-info w-100 text-white">📥 Raporu İndir</button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Font Awesome -->
<script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
<!-- xlsx JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

<script>
    async function downloadExcel(depoAdi) {
        try {
            const response = await fetch(`/Rapor/GetDepoVerileri?depo=${depoAdi}`);
            const data = await response.json();

            if (data.length === 0) {
                alert("Seçilen depoya ait veri bulunamadı.");
                return;
            }

            const worksheet = XLSX.utils.json_to_sheet(data);
            const workbook = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(workbook, worksheet, depoAdi);

            XLSX.writeFile(workbook, `${depoAdi}_Rapor.xlsx`);
        } catch (error) {
            console.error("Excel oluşturulurken hata:", error);
            alert("Rapor alınırken hata oluştu.");
        }
    }
</script>
